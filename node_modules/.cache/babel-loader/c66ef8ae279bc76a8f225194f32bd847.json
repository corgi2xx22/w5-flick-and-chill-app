{"ast":null,"code":"import _toConsumableArray from\"/Users/hellentrinh/Desktop/flick-and-chill/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Users/hellentrinh/Desktop/flick-and-chill/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/hellentrinh/Desktop/flick-and-chill/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/hellentrinh/Desktop/flick-and-chill/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useCallback}from'react';import{useHistory,useParams}from'react-router';import'./movie-grid.scss';import MovieCard from'../movie-card/MovieCard';import Button,{OutlineButton}from'../button/Button';import Input from'../input/Input';import tmdbApi,{category,movieType,tvType}from'../../api/tmdbApi';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MovieGrid=function MovieGrid(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),items=_useState2[0],setItems=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),page=_useState4[0],setPage=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),totalPage=_useState6[0],setTotalPage=_useState6[1];var _useParams=useParams(),keyword=_useParams.keyword;useEffect(function(){var getList=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,params,_params;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:response=null;if(!(keyword===undefined)){_context.next=15;break;}params={};_context.t0=props.category;_context.next=_context.t0===category.movie?6:10;break;case 6:_context.next=8;return tmdbApi.getMoviesList(movieType.upcoming,{params:params});case 8:response=_context.sent;return _context.abrupt(\"break\",13);case 10:_context.next=12;return tmdbApi.getTvList(tvType.popular,{params:params});case 12:response=_context.sent;case 13:_context.next=19;break;case 15:_params={query:keyword};_context.next=18;return tmdbApi.search(props.category,{params:_params});case 18:response=_context.sent;case 19:setItems(response.results);setTotalPage(response.total_pages);case 21:case\"end\":return _context.stop();}}},_callee);}));return function getList(){return _ref.apply(this,arguments);};}();getList();},[props.category,keyword]);var loadMore=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,params,_params2;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:response=null;if(!(keyword===undefined)){_context2.next=15;break;}params={page:page+1};_context2.t0=props.category;_context2.next=_context2.t0===category.movie?6:10;break;case 6:_context2.next=8;return tmdbApi.getMoviesList(movieType.upcoming,{params:params});case 8:response=_context2.sent;return _context2.abrupt(\"break\",13);case 10:_context2.next=12;return tmdbApi.getTvList(tvType.popular,{params:params});case 12:response=_context2.sent;case 13:_context2.next=19;break;case 15:_params2={page:page+1,query:keyword};_context2.next=18;return tmdbApi.search(props.category,{params:_params2});case 18:response=_context2.sent;case 19:setItems([].concat(_toConsumableArray(items),_toConsumableArray(response.results)));setPage(page+1);case 21:case\"end\":return _context2.stop();}}},_callee2);}));return function loadMore(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"section mb-3\",children:/*#__PURE__*/_jsx(MovieSearch,{category:props.category,keyword:keyword})}),/*#__PURE__*/_jsx(\"div\",{className:\"movie-grid\",children:items.map(function(item,i){return/*#__PURE__*/_jsx(MovieCard,{category:props.category,item:item},i);})}),page<totalPage?/*#__PURE__*/_jsx(\"div\",{className:\"movie-grid__loadmore\",children:/*#__PURE__*/_jsx(OutlineButton,{className:\"small\",onClick:loadMore,children:\"Load more\"})}):null]});};var MovieSearch=function MovieSearch(props){var history=useHistory();var _useState7=useState(props.keyword?props.keyword:''),_useState8=_slicedToArray(_useState7,2),keyword=_useState8[0],setKeyword=_useState8[1];var goToSearch=useCallback(function(){if(keyword.trim().length>0){history.push(\"/\".concat(category[props.category],\"/search/\").concat(keyword));}},[keyword,props.category,history]);useEffect(function(){var enterEvent=function enterEvent(e){e.preventDefault();if(e.keyCode===13){goToSearch();}};document.addEventListener('keyup',enterEvent);return function(){document.removeEventListener('keyup',enterEvent);};},[keyword,goToSearch]);return/*#__PURE__*/_jsxs(\"div\",{className:\"movie-search\",children:[/*#__PURE__*/_jsx(Input,{type:\"text\",placeholder:\"Enter keyword\",value:keyword,onChange:function onChange(e){return setKeyword(e.target.value);}}),/*#__PURE__*/_jsx(Button,{className:\"small\",onClick:goToSearch,children:\"Search\"})]});};export default MovieGrid;","map":{"version":3,"sources":["/Users/hellentrinh/Desktop/flick-and-chill/src/components/movie-grid/MovieGrid.jsx"],"names":["React","useState","useEffect","useCallback","useHistory","useParams","MovieCard","Button","OutlineButton","Input","tmdbApi","category","movieType","tvType","MovieGrid","props","items","setItems","page","setPage","totalPage","setTotalPage","keyword","getList","response","undefined","params","movie","getMoviesList","upcoming","getTvList","popular","query","search","results","total_pages","loadMore","map","item","i","MovieSearch","history","setKeyword","goToSearch","trim","length","push","enterEvent","e","preventDefault","keyCode","document","addEventListener","removeEventListener","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useHistory, useParams } from 'react-router';\n\nimport './movie-grid.scss';\n\nimport MovieCard from '../movie-card/MovieCard';\nimport Button, { OutlineButton } from '../button/Button';\nimport Input from '../input/Input'\n\nimport tmdbApi, { category, movieType, tvType } from '../../api/tmdbApi';\n\nconst MovieGrid = props => {\n\n    const [items, setItems] = useState([]);\n\n    const [page, setPage] = useState(1);\n    const [totalPage, setTotalPage] = useState(0);\n\n    const { keyword } = useParams();\n\n    useEffect(() => {\n        const getList = async () => {\n            let response = null;\n            if (keyword === undefined) {\n                const params = {};\n                switch(props.category) {\n                    case category.movie:\n                        response = await tmdbApi.getMoviesList(movieType.upcoming, {params});\n                        break;\n                    default:\n                        response = await tmdbApi.getTvList(tvType.popular, {params});\n                }\n            } else {\n                const params = {\n                    query: keyword\n                }\n                response = await tmdbApi.search(props.category, {params});\n            }\n            setItems(response.results);\n            setTotalPage(response.total_pages);\n        }\n        getList();\n    }, [props.category, keyword]);\n\n    const loadMore = async () => {\n        let response = null;\n        if (keyword === undefined) {\n            const params = {\n                page: page + 1\n            };\n            switch(props.category) {\n                case category.movie:\n                    response = await tmdbApi.getMoviesList(movieType.upcoming, {params});\n                    break;\n                default:\n                    response = await tmdbApi.getTvList(tvType.popular, {params});\n            }\n        } else {\n            const params = {\n                page: page + 1,\n                query: keyword\n            }\n            response = await tmdbApi.search(props.category, {params});\n        }\n        setItems([...items, ...response.results]);\n        setPage(page + 1);\n    }\n\n    return (\n        <>\n            <div className=\"section mb-3\">\n                <MovieSearch category={props.category} keyword={keyword}/>\n            </div>\n            <div className=\"movie-grid\">\n                {\n                    items.map((item, i) => <MovieCard category={props.category} item={item} key={i}/>)\n                }\n            </div>\n            {\n                page < totalPage ? (\n                    <div className=\"movie-grid__loadmore\">\n                        <OutlineButton className=\"small\" onClick={loadMore}>Load more</OutlineButton>\n                    </div>\n                ) : null\n            }\n        </>\n    );\n}\n\nconst MovieSearch = props => {\n\n    const history = useHistory();\n\n    const [keyword, setKeyword] = useState(props.keyword ? props.keyword : '');\n\n    const goToSearch = useCallback(\n        () => {\n            if (keyword.trim().length > 0) {\n                history.push(`/${category[props.category]}/search/${keyword}`);\n            }\n        },\n        [keyword, props.category, history]\n    );\n\n    useEffect(() => {\n        const enterEvent = (e) => {\n            e.preventDefault();\n            if (e.keyCode === 13) {\n                goToSearch();\n            }\n        }\n        document.addEventListener('keyup', enterEvent);\n        return () => {\n            document.removeEventListener('keyup', enterEvent);\n        };\n    }, [keyword, goToSearch]);\n\n    return (\n        <div className=\"movie-search\">\n            <Input\n                type=\"text\"\n                placeholder=\"Enter keyword\"\n                value={keyword}\n                onChange={(e) => setKeyword(e.target.value)}\n            />\n            <Button className=\"small\" onClick={goToSearch}>Search</Button>\n        </div>\n    )\n}\n\nexport default MovieGrid;\n"]},"metadata":{},"sourceType":"module"}